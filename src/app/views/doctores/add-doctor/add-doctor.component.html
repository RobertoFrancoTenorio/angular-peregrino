<div *ngIf="!done">
  cargando...
</div>

<div *ngIf="!done">
  cargando...
</div>

<div class='contenedor-principal' *ngIf="done">
  <nav class="navbar navbar-light bg-light">
      <div class="container-fluid">
          <a class="navbar-brand"><fa-icon [icon]="faUserMd"></fa-icon> Agregar Doctor</a>
      </div>
  </nav>
  <div class="card">
    <h5 class="card-header">Llena todos los campos del Doctor</h5>
    <div class="card-body">
      <h5><fa-icon [icon]="faUserEdit"></fa-icon> Datos Doctor</h5>
      <form [formGroup]="doctorForm" (ngSubmit)="addDoctor()">
        <div class="row">
            <div class="col-6">
              <label for="">Nombre</label>
              <input type="text" formControlName="userName" class="form-control">
            </div>
            <div class="col-3">
              <label for="">Primer Apellido</label>
              <input type="text" formControlName="primerApellido" class="form-control">
            </div>
          <div class="col-3">
              <label for="">Segundo Apellido</label>
              <input type="text" formControlName="segundoApellido" class="form-control">
          </div>
        </div>

        <div class="row" id="curpCedula">
          <div class="col-6">
            <label for="">CURP</label>
            <input type="text" formControlName="curp" class="form-control" [ngClass]="">
          </div>

          <div class="col-6">
            <label class="">Cédula Profesional</label>
              <input type="text" formControlName="cedula" class="form-control" (keypress)="numberOnly($event)">
          </div>
        </div>

        <div class="row" id="especialidad">
          <div class="col-5">
            <label for="">Especialidad</label>
            <input type="text" formControlName="especialidad" class="form-control">
          </div>
          <div class="col-4" *ngIf="currentUser">
            <label class="">Estado del Doctor</label>
                <select class="form-control" formControlName="activo" [(ngModel)]="varActivo">
                  <option [ngValue]="true" >Activo</option>
                  <option [ngValue]="false">Inactivo</option>
                </select>
                <small id="notificacion" class="form-text"><fa-icon [icon]="alert"></fa-icon> Este campo es para indicar si el doctor se encuentra activo en la clínica o no.</small>
            </div>
          </div>
        <br>
        <hr>

        <h5 class="direccionH5"><fa-icon [icon]="faRoute"></fa-icon> Dirección</h5>
        <div class="row" >
          <div class="col-6">
            <label for="" class="exampleFormControlInput1">Estado</label>
            <input type="text" formControlName="estado" class="form-control">
          </div>

          <div class="col-6">
            <label for="">Municipio</label>
            <input type="text" formControlName="municipio" class="form-control">
          </div>
        </div>

        <div class="row" id="direccion" >
          <div class="col-4">
            <label for="" class="input">Colonia</label>
            <input type="text" formControlName="colonia" class="form-control">
          </div>
          <div class="col-4">
            <label for="">Calle</label>
            <input type="text" formControlName="calle" class="form-control">
          </div>
          <div class="col-2">
            <label for="">Número</label>
            <input type="text" formControlName="no" class="form-control">
          </div>
          <div class="col-2">
            <label for="">Código Postal</label>
            <input type="text" formControlName="cp" class="form-control">
          </div>
        </div>
        <hr>
        <h5 class="titulo"><fa-icon [icon]="faCommentMedical"></fa-icon> Contacto</h5>

          <div class="row">
            <div class="col-6">
              <label class="">Correo Electrónico</label>
              <div class="input-group">
                <span class="input-group-text" id="basic-addon1"><fa-icon [icon]="at"></fa-icon></span>
                <input type="text" class="form-control" formControlName="email" [ngClass]="{ 'is-invalid': f.email.errors }">
                <div *ngIf="f.email.errors" class="invalid-feedback">
                    <div *ngIf="f.email.errors.required">El correo electrónico es requerido</div>
                    <div *ngIf="f.email.errors.email">Formato de correo invalido</div>
                </div>
              </div>

            </div>
            <div class="col-6">
              <label class="">Teléfono</label>
              <div class="input-group mb-3">
                <span class="input-group-text" id="basic-addon1"><fa-icon [icon]="fa"></fa-icon></span>
                <input type="text" class="form-control" formControlName="telefono" (keypress)="numberOnly($event)">
              </div>
            </div>
          </div>
          <button type="button" class="btn btn-success" (click)="addMetodo()" id="addMetodo"><fa-icon [icon]="faPlus"></fa-icon></button><spans>Agregar Metodo de Contacto</spans>
          <ng-container formArrayName="metodos">
            <ng-container *ngFor="let metodoForm of metodos.controls; let i = index">
              <div class="row" [formGroup]="metodoForm">
                  <div class="col-3">
                    <label for="" class="labelMetodo">Tipo de Contacto</label>
                    <input type="text" formControlName="metodo" class="form-control" id="#inputMetodo">
                  </div>
                  <div class="col-3">
                    <label for="" class="labelMetodo">Telefono</label>
                    <div class="input-group">
                      <span class="input-group-text" id="basic-addon1"><fa-icon [icon]="fa"></fa-icon></span>
                      <input type="text" formControlName="telefonoAux" class="form-control" id="#inputMetodo" (keypress)="numberOnly($event)">
                    </div>
                  </div>
                  <div class="col-3">
                    <label for="" class="labelMetodo">Horario</label>
                    <div class="input-group">
                      <span class="input-group-text" id="basic-addon1"><fa-icon [icon]="clock"></fa-icon></span>
                      <input type="text" formControlName="horario" class="form-control" id="#inputMetodo">
                    </div>
                  </div>
                  <div class="col-2">
                    <div class="row">
                      <button type="button" class="btn btn-danger" (click)="deleteMetodo(i)" id="delete"><fa-icon [icon]="faEraser"></fa-icon> Eliminar</button>
                    </div>
                  </div>
              </div>
            </ng-container>
          </ng-container>



        <div class="d-grid gap-2 d-md-flex justify-content-md-end">
            <button *ngIf="!currentUser" class="btn btn-success me-md-2" type="submit" [disabled]="!doctorForm.valid" >Guardar</button>
            <button *ngIf="currentUser" class="btn btn-success me-md-2" (click)="updateDoctor()" type="button" [disabled]="!doctorForm.valid" >Actualizar</button>
            <button class="btn btn-danger" type="button" (click)="goToDoctors()">Cancelar</button>
          </div>
    </form>
    </div>
  </div>

</div>
